# Article Skill Generator (Meta-Script)

This is a **meta-script** that generates other skills (`article-templates` and `tone-guidelines`) based on pattern analysis results from your existing articles.

## 1. Purpose

Generate customized writing guidelines and templates by analyzing patterns extracted from your own articles.

**Input**: JSON output from `scripts/pattern_extraction.md`
**Output**: Two dynamic skills (`article-templates` and `tone-guidelines`)

## 2. Input Requirements

This script expects JSON input from `scripts/pattern_extraction.md` with the following structure:

```json
{
  "analysis_metadata": {
    "total_articles": number,
    "platforms": {
      "platform_name": number
    },
    "analyzed_at": "YYYY-MM-DD HH:MM:SS"
  },
  "categories": [
    {
      "platform": "string",
      "category_name": "string",
      "article_count": number,
      "percentage": number,
      "section_patterns": ["string"],
      "average_sections": number,
      "common_section_names": ["string"]
    }
  ],
  "tone_patterns": {
    "writing_style": {
      "form": "desu/masu | da/dearu",
      "formality": "polite | casual | academic"
    },
    "common_expressions": ["string"],
    "formatting_rules": {
      "line_breaks": "string",
      "code_blocks": "string",
      "lists": "string",
      "headings": "string"
    },
    "terminology": {
      "technical_terms": ["string"],
      "standardized_words": {
        "term": "preferred_usage"
      }
    }
  },
  "code_patterns": {
    "total_code_blocks": number,
    "average_per_article": number,
    "languages": {
      "language_name": {
        "count": number,
        "percentage": number
      }
    },
    "code_explanation_style": "string"
  },
  "platform_usage": {
    "platform_name": {
      "count": number,
      "percentage": number
    }
  },
  "intro_outro_patterns": {
    "introduction": {
      "common_starts": ["string"],
      "typical_length": "short | medium | long"
    },
    "conclusion": {
      "common_ends": ["string"],
      "typical_length": "short | medium | long"
    }
  }
}
```

## 3. Generation Modes

### 3.1 Create Mode (Initial Generation)

Use when generating skills for the first time (no existing `article-templates` or `tone-guidelines`).

**Workflow**:
1. Receive pattern extraction JSON
2. Generate `article-templates` skill from scratch
3. Generate `tone-guidelines` skill from scratch (templates/ and generated/)
4. Add generation metadata to all files

### 3.2 Update Mode (Merge with Existing)

Use when updating existing skills with new patterns from additional articles.

**Workflow**:
1. Check if `article-templates` and `tone-guidelines` exist
2. Read existing skill files
3. Merge new patterns with existing content
4. Preserve custom modifications (marked with `# CUSTOM` comments)
5. Update version numbers
6. Add update metadata

## 4. article-templates Skill Generation

### 4.1 Generate SKILL.md

**Output Location**: `.claude/skills/article-templates/SKILL.md`

**File Structure**:

```markdown
---
name: article-templates
description: A collection of templates supporting article outline design. Generated by generate-templates based on {total_articles} analyzed articles. Last updated: {date}.
---

# Article Structure Templates (Skill)

<!-- Generated by generate-templates -->
<!-- Generated at: {timestamp} -->
<!-- Based on: {total_articles} articles analyzed -->
<!-- Version: {version} -->

This skill provides templates for designing technical article structures.
Used in Phase 2 (Outline Design Phase) of the article skill.

## 1. Category-Based Template Structure

Categories are generated based on your articles.

| Platform | Category | Article Count | Percentage | Template |
|----------|----------|---------------|------------|----------|
{category_table_rows}

## 2. Frontmatter Formats

### 2.1 Default Format (Platform-Agnostic)

```yaml
---
title: "Article Title"
date: "YYYY-MM-DD"
tags: ["tag1", "tag2", "tag3"]
---
```

### 2.2 Platform-Specific Formats

Refer to official documentation for platform-specific frontmatter:

**Qiita**:
- Qiita Markdown: https://qiita.com/Qiita/items/c686397e4a0f4f11683d
- Qiita CLI: https://qiita.com/Qiita/items/666e190490d0af90a92b

**Zenn**:
- Zenn CLI: https://zenn.dev/zenn/articles/zenn-cli-guide
- Zenn Markdown: https://zenn.dev/zenn/articles/markdown-guide

**Other platforms**: Use default format above.

## 3. Platform-Specific Syntax

Refer to official documentation instead of hardcoding platform-specific syntax:

- **Qiita**: https://qiita.com/Qiita/items/c686397e4a0f4f11683d
- **Zenn**: https://zenn.dev/zenn/articles/markdown-guide

## 4. Fixed Intro/Outro Templates

See `tone-guidelines` skill's `templates/intro_outro.md` or `generated/intro_outro.md` for fixed introduction and conclusion templates.

## 5. Output Format

Output outline design results in the following JSON format:

```json
{
  "platform": "qiita | zenn-article | zenn-book | other",
  "category": "string",
  "working_title": "string",
  "target_audience": "beginner | intermediate | advanced | mixed",
  "primary_goal": "string",
  "frontmatter": {
    "title": "string",
    "tags_or_topics": ["string"],
    "emoji": "string (Zenn only)",
    "type": "tech | idea (Zenn only)"
  },
  "sections": [
    {
      "id": "string",
      "title": "string",
      "goal": "string",
      "summary": "string",
      "depends_on": ["section_id"],
      "estimated_length": "short | medium | long"
    }
  ],
  "key_takeaways": ["string"],
  "prerequisites": ["string"]
}
```

## 6. Notes for Outline Design

### 6.1 Title Rules (Important)

Keep article titles short and simple.

**Prohibited Patterns**:
- Do not split titles with ":" or "："
- Avoid subtitle format ("〇〇：△△の仕組みと可能性")
- Avoid titles over 30 characters

**Recommended Patterns**:
- Good: "オンチェーンFXを実現するCircleのStableFX"
- Good: "ERC20の基本を理解する"
- Bad: "Circle StableFX：オンチェーンFXエンジンの仕組みと可能性"

### 6.2 Patterns to Avoid

- Abstract titles ("概要" or "まとめ" alone is unclear)
- Too many sections (guideline: 5-8 sections)
- Circular dependencies (avoid A→B→C→A)
- Overestimating prerequisite knowledge

### 6.3 Recommended Patterns

- Specific titles ("ERC20のapprove関数を理解する")
- Appropriate number of sections (5-8 sections)
- Clear dependencies (linear or tree structure)
- Gradual difficulty (basics first, advanced later)

## 7. Related Skills

- `generate-templates` - Generates this skill
- `tone-guidelines` - Used in writing phase
```

**Dynamic Content Generation**:

- `{category_table_rows}`: Generate from `categories` array in input JSON
- `{total_articles}`: From `analysis_metadata.total_articles`
- `{timestamp}`: Current timestamp
- `{version}`: Start with 1.0, increment for updates

### 4.2 Generate Category Templates

**Output Location**: `.claude/skills/article-templates/templates/{platform}/{category}.md`

**For each category** in the input JSON, generate a template file:

```markdown
# {Category Name} Template ({Platform})

<!-- Generated by generate-templates -->
<!-- Generated at: {timestamp} -->
<!-- Article count: {article_count} ({percentage}%) -->

{article_count} articles analyzed. This template captures common patterns.

## Metadata

(Platform-specific frontmatter example - refer to official docs)

## Article Structure

### 1. Introduction (Fixed)

See tone-guidelines skill's intro_outro.md for the fixed introduction template.

{for each section in section_patterns}
### {section_number}. {Section Name}

**Purpose**: {inferred from common patterns}
**Typical Content**: {inferred from analysis}
**Length Guide**: {inferred from average_sections}

{end for}

### {last_section}. Conclusion (Fixed)

See tone-guidelines skill's intro_outro.md for the fixed conclusion template.

## Writing Rules

### Category-Specific Rules

{inferred from category patterns}

## Checklist

- [ ] Metadata format is correct
- [ ] Introduction/Conclusion follows fixed template
- [ ] All required sections are included
- [ ] Section flow is logical
```

**Dynamic Content**:
- `{section_patterns}`: From category's `section_patterns` array
- Infer section purposes from common patterns
- Use `average_sections` to determine length guides

## 5. tone-guidelines Skill Generation

### 5.1 Generate SKILL.md

**Output Location**: `.claude/skills/tone-guidelines/SKILL.md`

**File Structure**:

```markdown
---
name: tone-guidelines
description: Tone and style guidelines for writing technical articles. Generated by generate-templates based on {total_articles} analyzed articles. Last updated: {date}.
---

# Tone and Style Guidelines (Skill)

<!-- Generated by generate-templates -->
<!-- Generated at: {timestamp} -->
<!-- Based on: {total_articles} articles analyzed -->
<!-- Version: {version} -->

This skill provides guidelines for tone and style when writing technical articles.
Used in Phase 3 (Writing Phase) of the article skill.

## Included Files

This skill consists of the following files.

### templates/ (User-Editable Placeholder Format)

**templates/format_rules.md**
Detailed formatting rules template with `[PLACEHOLDER]` format

**templates/wordings.md**
Terminology and writing style template with `[PLACEHOLDER]` format

**templates/intro_outro.md**
Introduction and conclusion template with `[PLACEHOLDER]` format

### generated/ (Auto-Generated Concrete Examples)

**generated/format_rules.md**
Actual formatting rules extracted from {total_articles} articles

**generated/wordings.md**
Actual writing patterns extracted from {total_articles} articles

**generated/intro_outro.md**
Actual intro/outro templates extracted from {total_articles} articles

## Key Principles

### Public Article Principles (Most Important)

All articles and Books are published externally.
Never include local file paths (`.claude/skills/...`, `/Users/...`), internal work notes, or project-specific internal information.
When references are needed, use official documentation or GitHub URLs that readers can access.
Always ask yourself "Is this information valuable to readers?"

### Title Rules

Keep article titles short and simple, aiming for under 30 characters.
Avoid subtitle formats that split titles with ":" or "：".

### Writing Style Rules

Use **{writing_style.form}** form consistently.

| Type | Recommended | Prohibited |
|------|-------------|------------|
| Explanations | {based on tone_patterns} | {based on tone_patterns} |
| Addressing readers | {based on tone_patterns} | {based on tone_patterns} |
| Technical facts | Clear assertions | Vague expressions |

### Platform-Specific Differences

Refer to official documentation for platform-specific syntax:

- **Qiita**: https://qiita.com/Qiita/items/c686397e4a0f4f11683d
- **Zenn**: https://zenn.dev/zenn/articles/markdown-guide

## Quality Checklist

After writing, verify the following.

| Category | Check Items |
|----------|-------------|
| Writing style | {generated from tone_patterns} |
| Format | {generated from formatting_rules} |
| Prohibited | No local file paths |
| Headings | {generated from formatting_rules.headings} |
| Code elements | {generated from code_patterns} |
| Platform | {platform-specific rules from official docs} |

## Related Skills

`generate-templates` is used to generate this skill.
`article-templates` is used in the outline design phase.
```

### 5.2 Generate templates/format_rules.md (Placeholder Format)

**Output Location**: `.claude/skills/tone-guidelines/templates/format_rules.md`

```markdown
---
description: Format Rules Template
version: 1.0.0
---

# フォーマットルール

<!-- ========================================
     以下の [PLACEHOLDER] を埋めてカスタマイズしてください
     コメント内の Generated Example は{total_articles}記事から抽出された参考例です
     詳細は generated/format_rules.md を参照してください
     ======================================== -->

## [RULE_1_NAME]
<!-- Generated Example: 句点と改行のルール -->

**優先度**: [PRIORITY]
<!-- Generated Example: CRITICAL -->

**説明**: [RULE_DESCRIPTION]
<!-- Generated Example: 日本語の句点（。）で文が終わったら、必ず改行します。 -->

### 良い例

[GOOD_EXAMPLE]
<!-- Generated Example:
これは最初の文です。
これは次の文です。
-->

### 悪い例

[BAD_EXAMPLE]
<!-- Generated Example: これは最初の文です。これは次の文です。 -->

---

## [RULE_2_NAME]
<!-- Generated Example: 句読点の使い方 -->

**優先度**: [PRIORITY]
<!-- Generated Example: CRITICAL -->

**説明**: [RULE_DESCRIPTION]
<!-- Generated Example: 文末をコロン（:、：）で終わらせることは絶対に禁止です。 -->

### 良い例

[GOOD_EXAMPLE]
<!-- Generated Example:
以下の点に注意してください。

- 点1
- 点2
-->

### 悪い例

[BAD_EXAMPLE]
<!-- Generated Example: 以下の点に注意してください: -->

---

<!-- ========================================
     カスタムルール追加エリア
     ======================================== -->

## カスタムルール

ここに独自のフォーマットルールを追加してください。
上記のルールと同じ形式で記述することを推奨します。

### 例: カスタムルール1

**優先度**: OPTIONAL

**説明**: ここにルールの説明を記述

### 良い例

ここに良い例を記述

### 悪い例

ここに悪い例を記述
```

### 5.3 Generate templates/wordings.md (Placeholder Format)

**Output Location**: `.claude/skills/tone-guidelines/templates/wordings.md`

```markdown
---
description: Wordings Template
version: 1.0.0
---

# 言い回しパターン

<!-- ========================================
     以下の [PLACEHOLDER] を埋めてカスタマイズしてください
     コメント内の Generated Example は{total_articles}記事から抽出された参考例です
     詳細は generated/wordings.md を参照してください
     ======================================== -->

## 導入フレーズ

### [PATTERN_1_NAME]
<!-- Generated Example: トピック紹介 -->

**使用場面**: [USAGE]
<!-- Generated Example: 記事のトピックを紹介する時 -->

**パターン**: [PATTERN]
<!-- Generated Example: この記事では、{topic}について解説します。 -->

**例**:
- [EXAMPLE_1]
  <!-- Generated Example: この記事では、ERC-20トークンについて解説します。 -->
- [EXAMPLE_2]
  <!-- Generated Example: この記事では、Reactのカスタムフックについて解説します。 -->

---

### [PATTERN_2_NAME]
<!-- Generated Example: 課題提示 -->

**使用場面**: [USAGE]
<!-- Generated Example: 解決したい課題を提示する時 -->

**パターン**: [PATTERN]
<!-- Generated Example: {problem}という課題があります。 -->

**例**:
- [EXAMPLE]
  <!-- Generated Example: NFTの所有権管理において、柔軟性が不足しているという課題があります。 -->

---

<!-- ========================================
     カスタムパターン追加エリア
     ======================================== -->

## カスタムパターン

ここに独自の言い回しパターンを追加してください。

### 例: カスタムパターン1

**使用場面**: ここに使用場面を記述

**パターン**: ここにパターンを記述

**例**:
- ここに例を記述
```

### 5.4 Generate templates/intro_outro.md (Placeholder Format)

**Output Location**: `.claude/skills/tone-guidelines/templates/intro_outro.md`

```markdown
---
description: Introduction and Conclusion Template
version: 1.0.0
---

# イントロ/アウトロテンプレート

<!-- ========================================
     以下のテンプレートをカスタマイズしてください
     Generated Example セクションに{total_articles}記事から抽出された参考例があります
     詳細は generated/intro_outro.md を参照してください
     ======================================== -->

## はじめに（Introduction）

### デフォルトテンプレート

```markdown
## はじめに

[GREETING]
<!-- Generated Example: こんにちは、{author_name}です。 -->

[TOPIC_INTRODUCTION]
<!-- Generated Example: この記事では、{topic}について解説します。 -->

[BACKGROUND]
<!-- Generated Example: 最近、{context}があり、調べる機会がありました。 -->

[ARTICLE_STRUCTURE]
<!-- Generated Example: まず基本を理解し、その後実装例を見ていきます。 -->
```

### プレースホルダー説明

- `[GREETING]`: 読者への挨拶（任意）
- `[TOPIC_INTRODUCTION]`: 記事のトピック紹介（必須）
- `[BACKGROUND]`: 背景・動機（任意）
- `[ARTICLE_STRUCTURE]`: 記事の構成説明（任意）

---

## 最後に（Conclusion）

### デフォルトテンプレート

```markdown
## 最後に

[SUMMARY]
<!-- Generated Example: この記事では、{topic}について解説しました。 -->

[NEXT_STEPS]
<!-- Generated Example: 次は{next_topic}について学んでみてください。 -->

[CALL_TO_ACTION]
<!-- Generated Example: 質問やフィードバックがあれば、コメントでお知らせください。 -->
```

### プレースホルダー説明

- `[SUMMARY]`: 記事の要約（必須）
- `[NEXT_STEPS]`: 次のステップ（任意）
- `[CALL_TO_ACTION]`: 行動喚起（任意）

---

<!-- ========================================
     カスタムテンプレート追加エリア
     ======================================== -->

## カスタムテンプレート

ここに独自のテンプレートを定義してください。

### 例: カスタムイントロ

```markdown
## はじめに

こんにちは、[YOUR_NAME]です。
Twitterでは @[YOUR_HANDLE] で活動しています。

この記事では、{topic}について解説します。

{background}

この記事が参考になれば幸いです。
```
```

### 5.5 Generate generated/format_rules.md (Concrete Examples)

**Output Location**: `.claude/skills/tone-guidelines/generated/format_rules.md`

```markdown
<!-- 自動生成: {total_articles}記事から抽出 -->
<!-- 生成日時: {timestamp} -->
<!-- Version: {version} -->
<!-- このファイルは参考例です。編集する場合は templates/format_rules.md を使用してください -->

# フォーマットルール（生成例）

## 1. 句点と改行のルール

**優先度**: CRITICAL

**説明**: 日本語の句点（。）で文が終わったら、必ず改行します。

**根拠**: 可読性を高め、文の区切りを明確にするため

### 良い例

これは最初の文です。
これは次の文です。

### 悪い例

これは最初の文です。これは次の文です。

---

## 2. 句読点の使い方

**優先度**: CRITICAL

**説明**: 文末をコロン（:、：）で終わらせることは絶対に禁止です。

**根拠**: 日本語の文法として不自然であり、一貫性を損なうため

**代替案**:
- 改行してから説明を続ける
- 「以下の通りです。」などの表現を使う

### 良い例

以下の点に注意してください。

- 点1
- 点2

### 悪い例

以下の点に注意してください:

---

{Additional rules generated from formatting_rules in input JSON}
```

### 5.6 Generate generated/wordings.md (Concrete Examples)

**Output Location**: `.claude/skills/tone-guidelines/generated/wordings.md`

```markdown
<!-- 自動生成: {total_articles}記事から抽出 -->
<!-- 生成日時: {timestamp} -->
<!-- Version: {version} -->
<!-- このファイルは参考例です。編集する場合は templates/wordings.md を使用してください -->

# 言い回し集（生成例）

このドキュメントは、技術記事執筆時に使用する具体的な言い回しの例を提供します。

## 0. よく使われる表現（{total_articles}記事から抽出）

**記事冒頭**:
{intro_outro_patterns.introduction.common_starts as list}

**記事末尾**:
{intro_outro_patterns.conclusion.common_ends as list}

**技術用語の説明**:
{tone_patterns.common_expressions as list}

{Additional wording patterns generated from tone_patterns in input JSON}
```

### 5.7 Generate generated/intro_outro.md (Concrete Examples)

**Output Location**: `.claude/skills/tone-guidelines/generated/intro_outro.md`

```markdown
<!-- 自動生成: {total_articles}記事から抽出 -->
<!-- 生成日時: {timestamp} -->
<!-- Version: {version} -->
<!-- このファイルは参考例です。編集する場合は templates/intro_outro.md を使用してください -->

# Intro/Outro Templates（生成例）

このファイルには固定の「はじめに」と「最後に」のテンプレートを定義しています。

---

## 1. Qiita用

### はじめに

```markdown
## はじめに

{Extracted common introduction pattern from Qiita articles}

今回は「**〇〇**」についてまとめていきます。
```

### 最後に

```markdown
## 最後に

今回は「**〇〇**」についてまとめてきました。

{Extracted common conclusion pattern from Qiita articles}
```

---

## 2. Zenn Article用

### はじめに

```markdown
## はじめに

{Extracted common introduction pattern from Zenn Article}

今回は「**〇〇**」についてまとめていきます。
```

### 最後に

```markdown
## 最後に

今回は「**〇〇**」についてまとめてきました。

{Extracted common conclusion pattern from Zenn Article}
```

---

{Additional platform-specific templates as needed}

## 使い方

1. 「**〇〇**」の部分を記事のテーマに置き換える
2. プラットフォームに応じたテンプレートを使用する
```

## 6. Update Mode (Merging Strategy)

### 6.1 Check for Existing Skills

Before generation:
1. Check if `.claude/skills/article-templates/SKILL.md` exists
2. Check if `.claude/skills/tone-guidelines/SKILL.md` exists
3. If both exist → Use Update Mode
4. If neither exists → Use Create Mode
5. If only one exists → Warn user and use Create Mode

### 6.2 Merge Strategy for article-templates

**SKILL.md**:
- Update category table (add new categories, update counts for existing)
- Preserve all other content
- Increment version number

**Category Templates**:
- For each new category → Create new template file
- For each existing category:
  - Read existing template
  - Merge section patterns (add new sections, update existing)
  - Preserve content marked with `# CUSTOM`
  - Update article count and percentage
  - Update timestamp

### 6.3 Merge Strategy for tone-guidelines

**SKILL.md**:
- Update metadata (article count, date)
- Preserve all content
- Increment version number

**templates/ files**:
- Preserve all user customizations
- Only update comments and examples if structure changes

**generated/ files**:
- Completely regenerate from new analysis results
- Update all statistics and examples
- Update timestamps

### 6.4 Version Numbering

**Versioning Rules**:
- Major version (X.0): Complete regeneration or significant structural changes
- Minor version (X.Y): Adding new categories, new rules, or incremental updates

**Current version detection**:
```markdown
<!-- Version: 1.2 -->
```

**Version increment logic**:
- If adding ≥3 new categories → Major version bump
- If adding <3 new categories or updating rules → Minor version bump

## 7. Custom Content Preservation

Content marked with `# CUSTOM` comments will be preserved during updates:

```markdown
# CUSTOM: This section is manually customized
{Your custom content here}
# END CUSTOM
```

**Preservation Rules**:
- Everything between `# CUSTOM` and `# END CUSTOM` is preserved
- Single-line `# CUSTOM` comments preserve the entire section until next heading
- Custom intro/outro templates are always preserved
- templates/ directory files are preserved (user customizations)

## 8. Output Summary

After generation, provide a detailed summary:

```
## Generated Skills

### article-templates
Location: .claude/skills/article-templates/
Status: {Created | Updated}
Version: {version}

Files:
- SKILL.md (updated)
- templates/
  {for each platform}
  - {platform}/
    {for each category}
    - {category}.md ({new | updated})

Statistics:
- Total categories: {count}
- New categories: {count}
- Updated categories: {count}
- Articles analyzed: {total_articles}

### tone-guidelines
Location: .claude/skills/tone-guidelines/
Status: {Created | Updated}
Version: {version}

Files:
- SKILL.md (updated)
- templates/ (user-editable):
  - format_rules.md (preserved)
  - wordings.md (preserved)
  - intro_outro.md (preserved)
- generated/ (auto-generated):
  - format_rules.md (regenerated)
  - wordings.md (regenerated)
  - intro_outro.md (regenerated)

Statistics:
- Total formatting rules: {count}
- Total common expressions: {count}
- Total technical terms: {count}
- Custom sections preserved: {count}

### Next Steps
1. Review generated skills in `.claude/skills/`
2. Customize templates/ files in `tone-guidelines/` (marked with [PLACEHOLDER])
3. Reference generated/ files for concrete examples
4. Run article skill to create articles using these skills
```

## 9. Error Handling

**Missing Required Fields**:
- If input JSON is missing required fields, report error with specific field names
- Suggest re-running pattern_extraction

**Empty Categories**:
- If no categories found, create a generic "Other" category
- Warn user that more articles are needed for better categorization

**File Write Errors**:
- Report which files failed to write
- Suggest checking file permissions
- Provide partial results if possible

## 10. Related Skills

- **generate-templates** - Uses this script to generate skills
- **article-templates** (generated) - Used by article skill
- **tone-guidelines** (generated) - Used by article skill
